Советник открывает ордера после пересечения быстрой и медленной MA расстояние между однонаправленными ордерами не может быть менее Step
Закрытие происходит по тейкпрофиту отложенному от точки общего безубытка. Так же есть настройка закрытия ордеров по суммарной прибыли в валюте депозита.

============================================

extern int     period_1             = 5,           //Период усреднения для вычисления первой MA.
               ma_shift_1           = 0,           //Сдвиг индикатора относительно ценового графика.
               ma_method_1          = MODE_EMA,    //Метод усреднения. Может быть любым из значений методов скользящего среднего (Moving Average).
                                                   //MODE_SMA 0 Простое скользящее среднее 
                                                   //MODE_EMA 1 Экспоненциальное скользящее среднее 
                                                   //MODE_SMMA 2 Сглаженное скользящее среднее 
                                                   //MODE_LWMA 3 Линейно-взвешенное скользящее среднее 

               applied_price_1      = PRICE_OPEN;  //Используемая цена. Может быть любой из ценовых констант.
                                                   //PRICE_CLOSE 0 Цена закрытия 
                                                   //PRICE_OPEN 1 Цена открытия 
                                                   //PRICE_HIGH 2 Максимальная цена 
                                                   //PRICE_LOW 3 Минимальная цена 
                                                   //PRICE_MEDIAN 4 Средняя цена, (high+low)/2 
                                                   //PRICE_TYPICAL 5 Типичная цена, (high+low+close)/3 
                                                   //PRICE_WEIGHTED 6 Взвешенная цена закрытия, (high+low+close+close)/4 

extern int     period_2             = 30,          //Период усреднения для вычисления второй MA.
               ma_shift_2           = 0,           //Сдвиг индикатора относительно ценового графика.
               ma_method_2          = MODE_LWMA,   //Метод усреднения. Может быть любым из значений методов скользящего среднего (Moving Average).
               applied_price_2      = PRICE_OPEN,  //Используемая цена. Может быть любой из ценовых констант.
               timeframe_2          = 0;           //Период. Может быть одним из периодов графика. 0 означает период текущего графика.

extern int     barOpen              = 1;           //бар на котором ждем сигнал (0- текущий  1 - прошлый)

extern bool    Buy            = true;  //разрешить сделки Buy
extern bool    Sell           = true;  //разрешить сделки Sell
extern int     Step           = 20;    //расстояние между открываемыми ордерами в сетке ордеров 
extern double  Lots           = 0.0;   //если=0 то лот будет расчитан как процент от свободных средств по RiskPercent % 
extern double  RiskPercent    = 0.01;  //Lots = AccountBalance() * (RiskPercent / 100.0) / 10000.0
extern double  K_Lot          = 1.5;   //умножение лота 
extern double  Max_Lot        = 150;   //ограничение размера лота
extern int     DigitsLot      = 2;     //кол-во знаков после запятой в размере лота (2 - 0,01) (1 - 0,1)
extern double  ProfitClose    = 0;     //прибыль в валюте депозита, при которой закрываем все ордера.

extern int     Takeprofit     = 35;
extern bool    деление.профита = true;   //ТР делится на кол-во колен

extern int     OrdersTrall    = 5;     //кол-во ордеров, после которого разрешаем тралить
extern bool    VirtualTS      = false; //выставлять виртуальный или реальный тралл 
extern int     TrailingStop   = 15;     //если 0 то нет тралла стоплоссов 

extern string   _____________  = "Filter Time";
extern int     TimeStart       = 0 ,    //ограничение времени работы советника
               TimeEnd         = 24,    //не открываем ордера и закрываем отложки если время не между TimeStart и TimeEnd
               FridayHourClose = 16;    //час закрытия ордеров в пятницу
              

extern string  ____________   = "";
extern bool    DrawInfo       = true;  //вывод информации на экран
int     размер_шрифта  = 10;    //размер шрифта
color   text_color     = Lime;  //цвет вывода информации

extern int     Magic          = 1000;  //уникальный номер ордеров этого советника для ордеров Buy 
extern int     Key            = 0;
